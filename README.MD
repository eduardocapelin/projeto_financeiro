# ğŸ’¸ Projeto de Controle Financeiro via Telegram

Este projeto foi desenvolvido para ajudar pessoas a manterem o controle de pequenos gastos do dia a dia. Muitas vezes fazemos compras pequenas que esquecemos de anotar, e no fim do mÃªs isso pesa. Com esse cÃ³digo, basta enviar uma mensagem no Telegram com o valor, descriÃ§Ã£o e forma de pagamento, e os dados serÃ£o automaticamente registrados em um arquivo Excel para facilitar a anÃ¡lise financeira.

---

## ğŸ¯ Objetivo

O principal objetivo Ã© automatizar o registro de pequenas despesas, garantindo que nenhuma compra passe despercebida. O usuÃ¡rio sÃ³ precisa enviar uma mensagem no formato correto para o bot no Telegram, e o sistema cuida do resto:

- Captura da mensagem via API do Telegram
- TransformaÃ§Ã£o da mensagem em dados estruturados
- Armazenamento em uma planilha Excel
- Evita perda de informaÃ§Ã£o e facilita a anÃ¡lise dos gastos

---

## ğŸ›  Tecnologias Utilizadas

- **Python** â€“ linguagem principal
- **pandas** â€“ manipulaÃ§Ã£o de dados
- **requests** â€“ requisiÃ§Ãµes HTTP
- **dotenv** â€“ gerenciamento de variÃ¡veis de ambiente
- **openpyxl** â€“ escrita em planilhas Excel (.xlsx)
- **Telegram Bot API** â€“ leitura das mensagens enviadas ao bot

---

## âš™ï¸ Como o CÃ³digo Funciona

1. **Leitura de mensagens no Telegram:**
   - Utiliza o token do bot armazenado no `.env`
   - Faz uma requisiÃ§Ã£o Ã  API do Telegram para obter as mensagens recentes

2. **TransformaÃ§Ã£o dos dados:**
   - Extrai `valor`, `descriÃ§Ã£o` e `forma_pagamento` da mensagem
   - Converte a data da mensagem para o formato datetime

3. **Leitura e atualizaÃ§Ã£o da planilha:**
   - Abre o arquivo Excel existente (mantendo outras abas intactas)
   - Adiciona os novos registros na aba "Base", evitando duplicaÃ§Ãµes

4. **GravaÃ§Ã£o final:**
   - Salva a nova versÃ£o do arquivo Excel com os dados atualizados

---

## ğŸ“¦ Estrutura Esperada da Mensagem no Telegram

Envie mensagens no seguinte formato para o bot:

49,90 Pizza PIX

- **Valor**: nÃºmero com vÃ­rgula ou ponto  
- **DescriÃ§Ã£o**: parte central da mensagem  
- **Forma de pagamento**: Ãºltima palavra (ex: PIX, CartÃ£o, Dinheiro)

---

Com esse fluxo simples, vocÃª consegue manter seu controle financeiro atualizado com rapidez e sem complicaÃ§Ãµes.